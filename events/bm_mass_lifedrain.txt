# lifedrain event

namespace = bm_mass_lifedrain

bm_mass_lifedrain.001 = {
	type = character_event
	title = bm_lifedrain.001.title
	desc = bm_lifedrain.001.desc
	theme = prison

	immediate = {
		every_prisoner = { save_scope_as = everyone_in_prison }
		every_prisoner = {
			limit = {
				# Not with good traits
				NOR = {
					has_trait = intellect_good
					has_trait = physique_good
					has_trait = beauty_good
					has_trait = giant
					has_trait = fecund
					has_trait = pure_blooded
				}
				# Not of your dynasty
				not = { is_close_family_of = scope:actor }
			}
			save_scope_as = everyone_in_prison_no_trait_not_related
		}
		
	}

	# Drain everyone
	option = {
		name = bm_mass_lifedrain.001.a
		ai_chance = { base = 5 }

		# Get lifeforce before they die
		every_prisoner = { root = { add_character_modifier = { modifier = lifeforce_modifier } } }
		
		# Execute everyone
		every_prisoner = {
			execute_prisoner_effect = {
				VICTIM = scope:recipient
				EXECUTIONER = root
			}
			# death = { death_reason = death_sacrificed_to_gods }
		}
	}

	# Do nothing
	option = {
		name = bm_mass_lifedrain.001.z 
		ai_chance = {
			base = 5
		}
	}
	
	# Portraits
	left_portrait ={
		character = root
		animation = rage
	}
}
